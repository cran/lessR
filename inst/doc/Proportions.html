<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="David Gerbing" />


<title>Proportion Inference</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Proportion Inference</h1>
<h4 class="author">David Gerbing</h4>


<div id="TOC">
<ul>
<li><a href="#test-of-a-specified-proportion">Test of a Specified Proportion</a>
<ul>
<li><a href="#single-proportion">Single Proportion</a></li>
<li><a href="#multiple-proportions">Multiple Proportions</a></li>
</ul></li>
<li><a href="#tests-without-a-specified-proportion">Tests without a Specified Proportion</a>
<ul>
<li><a href="#goodness-of-fit">Goodness-of-Fit</a></li>
<li><a href="#independence">Independence</a></li>
</ul></li>
</ul>
</div>

<p>The analysis of proportions is of two primary types.</p>
<ul>
<li>Focus on a single value of a categorical variable, termed a “success” when it occurs, for one or more samples of data. Analyze the resulting proportion of occurrence for a single sample or compare proportions of successes across distinct data samples for a single variable, a <em>homogeneity</em> test.</li>
<li>Compare the obtained proportions across the values of one or more categorical variables for a single sample, a <em>goodness-of-fit</em> test for a single variable, and a test of <em>independence</em> for multiple variables to evaluate a potential relationship between the variables.</li>
</ul>
<p>From standard base R functions, the <strong>lessR</strong> function <code>Prop_test()</code>, abbreviated <code>prop()</code>, provides either type of analysis. To use, generally enter either the original data from which to compute the sample proportions or enter already computed sample proportions. For the analysis of multiple categorical variables, the test of <em>homogeneity</em> and the test of <em>independence</em> yield the identical statistical result.</p>
<div id="test-of-a-specified-proportion" class="section level2">
<h2>Test of a Specified Proportion</h2>
<p>When the focus is on a designated value of the variable value, call such an occurrence a <code>success</code>. All other values of the variable are failures. Success or failure in this context does not necessarily mean good or bad, desired or undesired, but instead, a designated value either occurred or did not.</p>
<p>When analyzing proportions from data for a single categorical variable, indicate the variable’s name with the parameter <code>variable</code>. Entering a value of the variable for the parameter <code>success</code> triggers the test of homogeneity. When entering proportions directly, indicate the number of successes and the total number of trials with the <code>n_succ</code> and <code>n_tot</code> parameters. Enter the value of each parameter either as a single value for one sample or as a vector of multiple values for multiple samples. Without a value for <code>success</code> or <code>n_succ</code> the analysis is of goodness-of-fit or independence.</p>
<div id="single-proportion" class="section level3">
<h3>Single Proportion</h3>
<p>The example below is from the documentation for the base R function <code>binom.test()</code>, which provides the exact test of a null hypothesis regarding the probability of success. <code>Prop_test()</code>, which uses that base R function to compare a sample proportion to a hypothesized population value, yields the same result.</p>
<div id="from-input-frequencies" class="section level4">
<h4>From Input Frequencies</h4>
<p>For a given categorical variable of interest, a type of plant, consider two values, either “giant” or “dwarf”. From a sample of 925 plants, the specified value of “giant” occurred 682 times and did not occur 243 times. The null hypothesis tested is that the specified value occurs for 3/4 of the population according to the <code>p0</code> parameter.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Prop_test</span>(<span class="at">n_succ=</span><span class="dv">682</span>, <span class="at">n_fail=</span><span class="dv">243</span>, <span class="at">p0=</span>.<span class="dv">75</span>)</span></code></pre></div>
<pre><code>## 
## &gt;&gt;&gt; Exact binomial test of a proportion &lt;&lt;&lt; 
## 
## ------ Description ------
## 
## Number of successes: 682 
## Number of failures: 243 
## Number of trials: 925 
## Sample proportion: 0.737 
## 
## ------ Inference ------
## 
## Hypothesis test for null of 0.75, p-value: 0.382
## 95% Confidence interval: 0.708 to 0.765</code></pre>
</div>
<div id="from-data" class="section level4">
<h4>From Data</h4>
<p>To illustrate with data, read the <em>Jackets</em> data file included with <strong>lessR</strong> into the data frame <em>d</em>. The file contains two categorical variables. The variable <em>Bike</em> represents two different types of motorcycle: BMW and Honda. The second variable is <em>Jacket</em> with three values of jacket thickness: Lite, Med, and Thick.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">Read</span>(<span class="st">&quot;Jackets&quot;</span>)</span></code></pre></div>
<pre><code>## 
## &gt;&gt;&gt; Suggestions
## Details about your data, Enter:  details()  for d, or  details(name)
## 
## Data Types
## ------------------------------------------------------------
## character: Non-numeric data values
## ------------------------------------------------------------
## 
##     Variable                  Missing  Unique 
##         Name     Type  Values  Values  Values   First and last values
## ------------------------------------------------------------------------------------------
##  1      Bike character   1025       0       2   BMW  Honda  Honda ... Honda  Honda  BMW
##  2    Jacket character   1025       0       3   Lite  Lite  Lite ... Lite  Med  Lite
## ------------------------------------------------------------------------------------------</code></pre>
<p>For the <code>variable</code> <em>Bike</em> from the default <em>d</em> data frame, the parameter <code>success</code> applies to the <em>“BMW”</em> value of <em>Bike</em> in following example. Analyze the proportion of successes, those reporting a <em>Bike</em> of <em>“BMW”</em>. The default null hypothesis is a population value of 0.5, but here explicitly specify.</p>
<p>For clarity, the following example includes the parameter names listed with their corresponding values. These names are unnecessary in this example because the values are listed in the same order of their definition of the <code>Prop_test()</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Prop_test</span>(<span class="at">variable=</span>Bike, <span class="at">success=</span><span class="st">&quot;BMW&quot;</span>, <span class="at">p0=</span><span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## 
## &gt;&gt;&gt; Exact binomial test of a proportion &lt;&lt;&lt; 
## 
## Variable: Bike 
## success: BMW 
## 
## ------ Description ------
## 
## Number of missing values: 0 
## Number of successes: 418 
## Number of failures: 607 
## Number of trials: 1025 
## Sample proportion: 0.408 
## 
## ------ Inference ------
## 
## Hypothesis test for null of 0.5, p-value: 0.000
## 95% Confidence interval: 0.378 to 0.439</code></pre>
<p>Reject the null hypothesis, with a <span class="math inline">\(p\)</span>-value of 0.000, less than <span class="math inline">\(\alpha = 0.05\)</span>. The sample result of the sample proportion <span class="math inline">\(p=0.408\)</span> is considered far from the hypothesized value of <span class="math inline">\(0.5\)</span> for the proportion of <code>&quot;BMW&quot;</code> values for <em>Bike</em>. Conclude that the data were sampled from a population with a population proportion of BMW different from 0.5.</p>
</div>
</div>
<div id="multiple-proportions" class="section level3">
<h3>Multiple Proportions</h3>
<p>The following example is the same in the base R <code>prop.test()</code> documentation. <code>Prop_test()</code> relies upon that base R function to compare proportions across different groups and yield the same result. To indicate multiple proportions across groups, provide multiple values for the <code>n_succ</code> and <code>n_tot</code> parameters.</p>
<div id="from-input-frequencies-1" class="section level4">
<h4>From Input Frequencies</h4>
<p>The null hypothesis in this example is that the four populations of <em>patients</em> from which the samples were drawn have the same population proportion of <em>smokers</em>. The alternative is that at least one population proportion is different. Label the groups in the output by providing a named vector for the successes.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>smokers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">83</span>, <span class="dv">90</span>, <span class="dv">129</span>, <span class="dv">70</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(smokers) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Group1&quot;</span>,<span class="st">&quot;Group2&quot;</span>,<span class="st">&quot;Group3&quot;</span>,<span class="st">&quot;Group4&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>patients <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">86</span>, <span class="dv">93</span>, <span class="dv">136</span>, <span class="dv">82</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Prop_test</span>(<span class="at">n_succ=</span>smokers, <span class="at">n_tot=</span>patients)</span></code></pre></div>
<pre><code>## 
## &gt;&gt;&gt; 4-sample test for equality of proportions without continuity correction  &lt;&lt;&lt; 
## 
## 
## &gt;&gt;&gt; Description
## 
##               Group1   Group2   Group3   Group4
## -----------  -------  -------  -------  -------
## n_                83       90      129       70
## n_total           86       93      136       82
## proportion     0.965    0.968    0.949    0.854
## 
## &gt;&gt;&gt; Inference
## 
## Chi-square statistic: 12.600 
## Degrees of freedom: 3 
## Hypothesis test of equal population proportions: p-value = 0.006</code></pre>
<p>The result of the test is that the <span class="math inline">\(p\)</span>-value <span class="math inline">\(=0.006 &lt; \alpha=0.05\)</span>, so reject the null hypothesis of equal probabilities across the corresponding four populations. At least one of the population proportions of smokers differ.</p>
</div>
<div id="from-data-1" class="section level4">
<h4>From Data</h4>
<p>In the following example, duplicate the previous results from data. To illustrate, create the data frame <em>d</em> according to the proportions of smokers and non-smokers. Of course, in actual data analysis the data would already be available.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>sm1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;smoke&quot;</span>, <span class="dv">83</span>), <span class="fu">rep</span>(<span class="st">&quot;nosmoke&quot;</span>, <span class="dv">3</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>sm2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;smoke&quot;</span>, <span class="dv">90</span>), <span class="fu">rep</span>(<span class="st">&quot;nosmoke&quot;</span>, <span class="dv">3</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>sm3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;smoke&quot;</span>, <span class="dv">129</span>), <span class="fu">rep</span>(<span class="st">&quot;nosmoke&quot;</span>, <span class="dv">7</span>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>sm4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;smoke&quot;</span>, <span class="dv">70</span>), <span class="fu">rep</span>(<span class="st">&quot;nosmoke&quot;</span>, <span class="dv">12</span>))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>sm <span class="ot">&lt;-</span> <span class="fu">c</span>(sm1, sm2, sm3, sm4)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>,<span class="dv">86</span>), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>,<span class="dv">93</span>), <span class="fu">rep</span>(<span class="st">&quot;C&quot;</span>,<span class="dv">136</span>), <span class="fu">rep</span>(<span class="st">&quot;D&quot;</span>,<span class="dv">82</span>))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sm, grp)</span></code></pre></div>
<p>Examine the first six rows and last six rows of the data frame <em>d</em>. Indicate the variable of interest, <em>sm</em>, with values <em>“smoke”</em> and <em>“nosmoke”</em>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<pre><code>##      sm grp
## 1 smoke   A
## 2 smoke   A
## 3 smoke   A
## 4 smoke   A
## 5 smoke   A
## 6 smoke   A</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(d)</span></code></pre></div>
<pre><code>##          sm grp
## 392 nosmoke   D
## 393 nosmoke   D
## 394 nosmoke   D
## 395 nosmoke   D
## 396 nosmoke   D
## 397 nosmoke   D</code></pre>
<p>To indicate a comparison across groups, retain the format for a single proportion based on a value of a categorical <code>variable</code> of interest. Define success by the value of this variable, here <em>“smoke”</em>. This analysis indicates the comparison across the four groups with a grouping variable that contains a label that identifies the corresponding group. Specify the grouping variable with the <code>by</code> parameter. The grouping variable in this example is <em>grp</em>, with values the first four uppercase letters of the alphabet.</p>
<p>The relevant parameters <code>variable</code>, <code>success</code>, and <code>by</code> are listed in their given order in this example, so the parameter names are unnecessary. They are listed here for completeness.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Prop_test</span>(<span class="at">variable=</span>sm, <span class="at">success=</span><span class="st">&quot;smoke&quot;</span>, <span class="at">by=</span>grp)</span></code></pre></div>
<pre><code>## 
## &gt;&gt;&gt; 4-sample test for equality of proportions without continuity correction  &lt;&lt;&lt; 
## 
## Variable: sm 
## success: smoke 
## by: grp 
## 
## &gt;&gt;&gt; Description
## 
##                   A       B       C       D
## -----------  ------  ------  ------  ------
## n_smoke          83      90     129      70
## n_total          86      93     136      82
## proportion    0.965   0.968   0.949   0.854
## 
## &gt;&gt;&gt; Inference
## 
## Chi-square statistic: 12.600 
## Degrees of freedom: 3 
## Hypothesis test of equal population proportions: p-value = 0.006</code></pre>
<p>The analysis of data that matches the previously input proportions provides the same results as providing the proportions directly.</p>
</div>
</div>
</div>
<div id="tests-without-a-specified-proportion" class="section level2">
<h2>Tests without a Specified Proportion</h2>
<div id="goodness-of-fit" class="section level3">
<h3>Goodness-of-Fit</h3>
<p>For the previously discussed test of homogeneity of the values of a single categorical variable, the proportion of occurrences for a specific value across different samples is of interest. Here, the proportion of occurrence for each value is instead calculated against the total number of occurrences, as one sample from a single population.</p>
<div id="from-input-frequencies-2" class="section level4">
<h4>From Input Frequencies</h4>
<p>For the goodness-of-fit test to a uniform distribution, provide the frequencies for each group for the parameter <code>n_tot</code>. The default null hypothesis is that the proportions of the different categories of a categorical variable are equal.</p>
<p>In this example, enter five frequencies as a vector for the value of the <code>n_tot</code> parameter. Make the vector a named vector to label the output accordingly.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">372</span>, <span class="dv">342</span>, <span class="dv">311</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(x) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Lite&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;Thick&quot;</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Prop_test</span>(<span class="at">n_tot=</span>x)</span></code></pre></div>
<pre><code>## 
## &gt;&gt;&gt; Chi-squared test for given probabilities  &lt;&lt;&lt; 
## 
## 
## &gt;&gt;&gt; Description
## 
##                Lite       Med     Thick
## ---------  --------  --------  --------
## observed        372       342       311
## expected    341.667   341.667   341.667
## residual      1.641     0.018    -1.659
## stdn res      2.010     0.022    -2.032
## 
## &gt;&gt;&gt; Inference
## 
## Chi-square statistic: 5.446 
## Degrees of freedom: 2 
## Hypothesis test of equal population proportions: p-value = 0.066</code></pre>
</div>
<div id="from-data-2" class="section level4">
<h4>From Data</h4>
<p>The same analysis follows from the data.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">Read</span>(<span class="st">&quot;Jackets&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Prop_test</span>(Jacket)</span></code></pre></div>
<pre><code>## 
## &gt;&gt;&gt; Chi-squared test for given probabilities  &lt;&lt;&lt; 
## 
## Variable: Jacket 
## 
## &gt;&gt;&gt; Description
## 
##                Lite       Med     Thick
## ---------  --------  --------  --------
## observed        372       342       311
## expected    341.667   341.667   341.667
## residual      1.641     0.018    -1.659
## stdn res      2.010     0.022    -2.032
## 
## &gt;&gt;&gt; Inference
## 
## Chi-square statistic: 5.446 
## Degrees of freedom: 2 
## Hypothesis test of equal population proportions: p-value = 0.066</code></pre>
</div>
</div>
<div id="independence" class="section level3">
<h3>Independence</h3>
<p>Tests of goodness of fit and independence evaluated here rely upon a contingency table of one or two dimensions. Due to the awkwardness of entering a table of frequencies, <code>Prop_test()</code> relies upon computing the contingency table from the data, using the base R <code>chisq.test()</code> function. However, as shown next, there is a way to enter frequencies if comparing just two levels of a categorical variable.</p>
<div id="from-input-frequencies-3" class="section level4">
<h4>From Input Frequencies</h4>
<p>The <em>smokers</em> and <em>patients</em> vectors presented in a previous example together contain the information needed to construct the corresponding full contingency table. In that example, the <em>smokers</em> vector represents the frequencies of patients who smoked.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>smokers</span></code></pre></div>
<pre><code>## Group1 Group2 Group3 Group4 
##     83     90    129     70</code></pre>
<p>The <em>patients</em> vector represents the total number of patients in each of the four groups.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>patients</span></code></pre></div>
<pre><code>## [1]  86  93 136  82</code></pre>
<p>The previous analysis of the separate vectors is equivalent to the analysis of the full 2 x 4 contingency table of smokers and non-smokers according to the test of independence illustrated in the next section. Conceptually the tests are distinct, but computationally identical.</p>
<p>The construction of the following contingency table is not part of the input to <code>Prop_test()</code>. This illustration is included here solely to illustrate the equivalence of information provided by the two vectors and the full contingency table.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>cont_tbl <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">83</span>, <span class="dv">86-83</span>, <span class="dv">90</span>, <span class="dv">93-90</span>, <span class="dv">129</span>, <span class="dv">136-129</span>, <span class="dv">70</span>, <span class="dv">82-70</span>), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(cont_tbl) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Smoke =</span> <span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>),</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Group =</span> <span class="fu">c</span>(<span class="st">&quot;G1&quot;</span>,<span class="st">&quot;G2&quot;</span>,<span class="st">&quot;G3&quot;</span>,<span class="st">&quot;G4&quot;</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(cont_tbl)</span></code></pre></div>
<pre><code>##      Group
## Smoke G1 G2  G3 G4 Sum
##   Yes 83 90 129 70 372
##   No   3  3   7 12  25
##   Sum 86 93 136 82 397</code></pre>
<p>If comparing more than two levels of a categorical variable, and only the proportions and not the data are available, then follow the form of the previous construction of the contingency table from the given proportions. Then directly use the base R function <code>chisq.test()</code> to do the analysis.</p>
</div>
<div id="from-data-3" class="section level4">
<h4>From Data</h4>
<p>The <span class="math inline">\(\chi^2\)</span> test of independence evaluated here for two categorical variables. The first variable listed in this example is the value of the parameter <code>variable</code>, so does not need the parameter name. The second variable listed must include the parameter name <code>by</code>.</p>
<p>The question for the analysis is if the observed frequencies of <em>Jacket</em> thickness and <em>Bike</em> ownership are so different from the frequencies expected by the null hypothesis that we conclude the variables are related?</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Prop_test</span>(Jacket, <span class="at">by=</span>Bike)</span></code></pre></div>
<pre><code>## 
## &gt;&gt;&gt; Pearson&#39;s Chi-squared test  &lt;&lt;&lt; 
## 
## Variable: Jacket 
## by: Bike 
## 
## &gt;&gt;&gt; Description
## 
##        Jacket
## Bike    Lite  Med Thick  Sum
##   BMW     89  135   194  418
##   Honda  283  207   117  607
##   Sum    372  342   311 1025
## 
## Cramer&#39;s V: 0.319 
## 
## &gt;&gt;&gt; Inference
## 
## Chi-square statistic: 104.083 
## Degrees of freedom: 2 
## Hypothesis test of independence: p-value = 0.000</code></pre>
<p>The result of this test is that the <span class="math inline">\(p\)</span>-value = 0.000 <span class="math inline">\(&lt; \alpha=0.05\)</span>, so reject the null hypothesis of independence. Conclude that the type of <em>Bike</em> a person rides and the thickness of their <em>Jacket</em> are related.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
