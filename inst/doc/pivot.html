<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="David Gerbing" />


<title>Pivot Table</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Pivot Table</h1>
<h4 class="author">David Gerbing</h4>


<div id="TOC">
<ul>
<li><a href="#lessr-pivot-vs-base-r-aggregate"><strong>lessR</strong> <code>pivot()</code> vs <strong>Base R</strong> <code>aggregate()</code></a></li>
<li><a href="#parameters">Parameters</a></li>
<li><a href="#examples">Examples</a><ul>
<li><a href="#output-as-a-long-form-data-frame">Output as a long-form data frame</a></li>
<li><a href="#output-as-a-2-d-table">Output as a 2-d Table</a></li>
<li><a href="#tabulation">Tabulation</a></li>
<li><a href="#missing-data">Missing Data</a></li>
</ul></li>
</ul>
</div>

<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(<span class="st">&quot;lessR&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(<span class="st">&quot;knitr&quot;</span>)</span></code></pre></div>
<div id="lessr-pivot-vs-base-r-aggregate" class="section level2">
<h2><strong>lessR</strong> <code>pivot()</code> vs <strong>Base R</strong> <code>aggregate()</code></h2>
<p>Aggregation is the process forming groups of data based on the levels of categorical variables, then computing some statistical value, such as a mean, for each group on a numeric variable. For example, compute the mean Salary for each combination of the levels of Gender and Department. Refer to each group, the cross-classification of all the specified categorical variables, as a <em>cell</em>.</p>
<p>The <strong>lessR</strong> <code>pivot()</code> function performs this aggregation by relying upon the <strong>base R</strong> function <code>aggregate()</code>. By default, <code>pivot()</code> generates a long-form data frame pivot table (Excel terminology), which can then be directly input into analysis functions as a standard data frame. The levels for all the grouping variables are listed in the rows, but if there are specified column grouping variables, <code>pivot()</code> relies upon base R <code>reshape()</code> to form a 2-d table for direct viewing instead of a data table to input into further analysis functions.</p>
<p><code>pivot()</code> provides additional features than <code>aggregate()</code> provides.</p>
<ol style="list-style-type: decimal">
<li>If only one <code>value</code> over which to aggregate, the sample size for each cell is provided with the number of missing values.</li>
<li>Missing data analysis by cell or by <code>value</code> aggregated.</li>
<li>The aggregated computations can be displayed as a 2-d table, not just a long-form data frame.</li>
<li>The data parameter is listed first in the parameter list, which facilitates the use of the pipe operator from the <strong>magrittr</strong> package.</li>
</ol>
<p>Also, there is a different interface as the  variables, for rows and columns, are each specified as a vector.</p>
<p>The following table lists many of the available statistical functions by which to aggregate over the cells.</p>
<table>
<thead>
<tr class="header">
<th>Statistic</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>sum</code></td>
<td>sum</td>
</tr>
<tr class="even">
<td><code>mean</code></td>
<td>arithmetic mean</td>
</tr>
<tr class="odd">
<td><code>median</code></td>
<td>median</td>
</tr>
<tr class="even">
<td><code>min</code></td>
<td>minimum</td>
</tr>
<tr class="odd">
<td><code>max</code></td>
<td>maximum</td>
</tr>
<tr class="even">
<td><code>sd</code></td>
<td>standard deviation</td>
</tr>
<tr class="odd">
<td><code>var</code></td>
<td>variance</td>
</tr>
<tr class="even">
<td><code>IQR</code></td>
<td>inter-quartile range</td>
</tr>
<tr class="odd">
<td><code>mad</code></td>
<td>mean absolute deviation</td>
</tr>
<tr class="even">
<td><code>tabulate</code></td>
<td>count of each cell only</td>
</tr>
</tbody>
</table>
<p>Some statistical functions are available that return multiple values.</p>
<table>
<thead>
<tr class="header">
<th>Statistic</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>range</code></td>
<td>minimum, maximum</td>
</tr>
<tr class="even">
<td><code>quantile</code></td>
<td>range + quartiles</td>
</tr>
<tr class="odd">
<td><code>summary</code></td>
<td>quantile + mean</td>
</tr>
</tbody>
</table>
<p>These later three functions output their values as an R matrix, which then replaces the values of the variable that is aggregated in the resulting output data frame.</p>
</div>
<div id="parameters" class="section level2">
<h2>Parameters</h2>
<p>The following <code>pivot()</code> parameters specify the data, the statistic for the aggregation, the value(s) over which to aggregate, and the corresponding cells that contain the aggregated values. The first four parameter values listed below are required.</p>
<ol style="list-style-type: decimal">
<li><code>data</code>: The data frame that includes the variables of interest.</li>
<li><code>compute</code>: The function for which to perform the aggregation.</li>
<li><code>value</code>: The variable(s) for which to summarize, i.e., aggregate.</li>
<li><code>rows_by</code>: The categorical variable(s) that define the sub-groups or cells for which to compute the aggregated values.</li>
<li><code>cols_by</code>: The optional categorical variable(s) that define the sub-groups or cells for which to compute the aggregated values, listed as columns in a two-dimensional table.</li>
</ol>
<p>Multiple values of parameters <code>value</code>, <code>rows_by</code>, and up to two <code>cols_by</code> variables may be specified. Express the multiple categorical variables over which to pivot as a vector, such as with the <code>c()</code> function. If <code>cols_by</code> is not specified, the result is a linear table as a long-form data frame that can be input into other data analysis procedures.</p>
<p>By default, missing values are eliminated from the aggregation. If there are no values for a cell for which to perform the aggregation, and it is desired to have the aggregated value listed as missing, then specify <code>na_value</code> as <code>TRUE</code>. If any of the levels of the <code>by</code> variables are missing, to report those missing cells, specify <code>na_by</code> as <code>TRUE</code>. Set <code>na_remove</code> to <code>TRUE</code> to have any aggregated value defined as missing if any individual data cell for <code>value</code> is missing.</p>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<p>To illustrate, use the Employee data set included in <strong>lessR</strong>, here read into the <em>d</em> data frame. Begin with no missing data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>d &lt;-<span class="st"> </span><span class="kw">Read</span>(<span class="st">&quot;Employee&quot;</span>)</span></code></pre></div>
<pre><code>## 
## &gt;&gt;&gt; Suggestions
## Details about your data, Enter:  details()  for d, or  details(name)
## 
## Data Types
## ------------------------------------------------------------
## character: Non-numeric data values
## integer: Numeric data values, integers only
## double: Numeric data values with decimal digits
## ------------------------------------------------------------
## 
##     Variable                  Missing  Unique 
##         Name     Type  Values  Values  Values   First and last values
## ------------------------------------------------------------------------------------------
##  1     Years   integer     36       1      16   7  NA  15 ... 1  2  10
##  2    Gender character     37       0       2   M  M  M ... F  F  M
##  3      Dept character     36       1       5   ADMN  SALE  SALE ... MKTG  SALE  FINC
##  4    Salary    double     37       0      37   53788.26  94494.58 ... 56508.32  57562.36
##  5    JobSat character     35       2       3   med  low  low ... high  low  high
##  6      Plan   integer     37       0       3   1  1  3 ... 2  2  1
##  7       Pre   integer     37       0      27   82  62  96 ... 83  59  80
##  8      Post   integer     37       0      22   92  74  97 ... 90  71  87
## ------------------------------------------------------------------------------------------</code></pre>
<div id="output-as-a-long-form-data-frame" class="section level3">
<h3>Output as a long-form data frame</h3>
<p>Two categorical variables in the <em>d</em> data frame are <em>Dept</em> and <em>Salary</em>. A continuous variable is <em>Salary</em>. Create the long-form pivot table as a data frame that expresses the mean of <em>Salary</em> for all combinations of <em>Dept</em> and <em>Salary</em>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">pivot</span>(<span class="dt">data=</span>d, <span class="dt">compute=</span>mean, <span class="dt">value=</span>Salary, <span class="dt">rows_by=</span><span class="kw">c</span>(Dept, Gender))</span></code></pre></div>
<pre><code>##    Dept Gender  n miss   Salary
## 1  ACCT      F  3    0 63237.16
## 2  ADMN      F  4    0 81434.00
## 3  FINC      F  1    0 57139.90
## 4  MKTG      F  5    0 64496.02
## 5  SALE      F  5    0 64188.25
## 6  ACCT      M  2    0 59626.20
## 7  ADMN      M  2    0 80963.35
## 8  FINC      M  3    0 72967.60
## 9  MKTG      M  1    0 99062.66
## 10 SALE      M 10    0 86150.97</code></pre>
<p>The output of <code>pivot()</code> is a data frame of the aggregated variables. This can be saved for further analysis. Here, perform the same analysis, but list the required parameter values in order without the parameter names.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>a &lt;-<span class="st"> </span><span class="kw">pivot</span>(d, mean, Salary, <span class="kw">c</span>(Dept, Gender))</span></code></pre></div>
<p>Because the output of <code>pivot()</code> with no <code>cols_by</code> variables is a standard R data frame, typical operations such as sorting can be applied, here using the <strong>lessR</strong> function <code>Sort()</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">Sort</span>(a, <span class="dt">by=</span>Dept)</span></code></pre></div>
<pre><code>## 
## Sort Specification
##   1 --&gt;  ascending</code></pre>
<pre><code>##    Dept Gender  n miss   Salary
## 1  ACCT      F  3    0 63237.16
## 6  ACCT      M  2    0 59626.20
## 2  ADMN      F  4    0 81434.00
## 7  ADMN      M  2    0 80963.35
## 3  FINC      F  1    0 57139.90
## 8  FINC      M  3    0 72967.60
## 4  MKTG      F  5    0 64496.02
## 9  MKTG      M  1    0 99062.66
## 5  SALE      F  5    0 64188.25
## 10 SALE      M 10    0 86150.97</code></pre>
<p>Multiple <code>value</code> variables for which to aggregate over can also be specified. Round the numerical aggregated results to two decimal digits.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">pivot</span>(d, mean, <span class="kw">c</span>(Years, Salary), <span class="kw">c</span>(Dept, Gender), <span class="dt">digits_d=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>##    Dept Gender  n miss Years   Salary
## 1  ACCT      F  3    0  4.67 63237.16
## 2  ADMN      F  4    0  7.50 81434.00
## 3  FINC      F  1    0  7.00 57139.90
## 4  MKTG      F  5    0  8.20 64496.02
## 5  SALE      F  5    0  6.60 64188.25
## 6  ACCT      M  2    0  7.00 59626.20
## 7  ADMN      M  2    0 15.50 80963.34
## 8  FINC      M  3    0 11.33 72967.60
## 9  MKTG      M  1    0 18.00 99062.66
## 10 SALE      M 10    0 12.33 86150.97</code></pre>
<p>The following illustrates the pipe operator from the <strong>magrittr</strong> package with <code>pivot()</code>. The package is not included with <strong>lessR</strong>, so separately load with <code>library()</code>, either by itself or as part of the <strong>tidyverse</strong> package. As such, the following code is not run.</p>
<p>Perform the pivot computations on the <em>d</em> data frame. Then output the aggregated results to the <em>a</em> data frame.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># d %&gt;% pivot(mean, Salary, c(Dept, Gender)) %&gt;% -&gt; a</span></span></code></pre></div>
</div>
<div id="output-as-a-2-d-table" class="section level3">
<h3>Output as a 2-d Table</h3>
<p>Specify up to two <code>cols_by</code> categorical variables, to create a two-dimensional table with the specified columns. First, one <code>cols_by</code> variable, Gender. Specifying one or two categorical variables as <code>cols_by</code> variables moves them from their default position in the rows to the columns, which changes the output structure from a long-form data frame to a cross-classification table with categorical variables in the rows and columns.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">pivot</span>(d, mean, Salary, Dept, Gender)</span></code></pre></div>
<pre><code>Table: mean of Salary 

 Gender  F          M               
 Dept                        
-------  ---------  ---------
   ACCT   63237.16   59626.20
   ADMN   81434.00   80963.34
   FINC   57139.90   72967.60
   MKTG   64496.02   99062.66
   SALE   64188.25   86150.97</code></pre>
<p>Here two <code>cols_by</code> variables, specified as a vector.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">pivot</span>(d, mean, Salary, Dept, <span class="kw">c</span>(Gender, Plan))</span></code></pre></div>
<pre><code>Table: mean of Salary 

 Gender  F                                M                                      
 Plan    1          2          3          1          2           3             
 Dept                                                                     
-------  ---------  ---------  ---------  ---------  ----------  ---------
   MKTG   56772.95   66426.79         NA         NA          NA   99062.66
   SALE   60941.54   66352.73         NA   89393.40    82442.74   80131.91
   ACCT         NA   63237.16         NA   69547.60          NA   49704.79
   ADMN         NA   67724.21   122563.4   53788.26   108138.43         NA
   FINC         NA   57139.90         NA   61937.62          NA   95027.55</code></pre>
</div>
<div id="tabulation" class="section level3">
<h3>Tabulation</h3>
<p>Tabulation is counting. With tabulation there is no <code>value</code> variable per se. Instead, the number of data values in each cell are tabulated, that is, counted.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">pivot</span>(d, tabulate, <span class="kw">c</span>(Dept, Gender))</span></code></pre></div>
<pre><code>##    Dept Gender  n
## 1  ACCT      F  3
## 2  ADMN      F  4
## 3  FINC      F  1
## 4  MKTG      F  5
## 5  SALE      F  5
## 6  ACCT      M  2
## 7  ADMN      M  2
## 8  FINC      M  3
## 9  MKTG      M  1
## 10 SALE      M 10</code></pre>
</div>
<div id="missing-data" class="section level3">
<h3>Missing Data</h3>
<p>The pivot table follows with the missing data analysis when there is only one numerical value over which to aggregate. The variable <em>Years</em> has one missing value.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">pivot</span>(d, mean, Years, Dept)</span></code></pre></div>
<pre><code>##     by  n miss     Years
## 1 ACCT  5    0  5.600000
## 2 ADMN  6    0 10.166667
## 3 FINC  4    0 10.250000
## 4 MKTG  6    0  9.833333
## 5 SALE 14    1 10.285714</code></pre>
<p>Set <code>na_remove</code> to <code>FALSE</code> to <em>not</em> remove any missing data in a cell with values to be aggregated. The resulting aggregated value will be missing if any of the constituent data values are missing. The corresponding level does not appear because cells with aggregated missing values are not shown.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">pivot</span>(d, mean, Years, Dept, <span class="dt">na_remove=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>##     by n miss     Years
## 1 ACCT 5    0  5.600000
## 2 ADMN 6    0 10.166667
## 3 FINC 4    0 10.250000
## 4 MKTG 6    0  9.833333</code></pre>
<p>The <code>na_remove</code> parameter specifies the value of the base R parameter <code>na.rm</code> for computations such as for the <code>mean</code>. See <code>?mean</code> for its definition.</p>
<p>Here include all the cells, even those with a missing aggregated value.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">pivot</span>(d, mean, Years, Dept, <span class="dt">na_remove=</span><span class="ot">FALSE</span>, <span class="dt">na_value=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>##     by  n miss     Years
## 1 ACCT  5    0  5.600000
## 2 ADMN  6    0 10.166667
## 3 FINC  4    0 10.250000
## 4 MKTG  6    0  9.833333
## 5 SALE 14    1        NA</code></pre>
<p>To account for missing values of the categorical <code>by</code> variables, set <code>na_by</code> to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">pivot</span>(d, mean, Years, <span class="kw">c</span>(Dept, Gender), <span class="dt">na_by=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>##    Dept Gender n miss     Years
## 1  ACCT      F 3    0  4.666667
## 2  ADMN      F 4    0  7.500000
## 3  FINC      F 1    0  7.000000
## 4  MKTG      F 5    0  8.200000
## 5  SALE      F 5    0  6.600000
## 6  &lt;NA&gt;      F 1    0  5.000000
## 7  ACCT      M 2    0  7.000000
## 8  ADMN      M 2    0 15.500000
## 9  FINC      M 3    0 11.333333
## 10 MKTG      M 1    0 18.000000
## 11 SALE      M 9    1 12.333333</code></pre>
<p>Specify the count for levels that include missing cells. Invoke <code>na_by</code> for tabulation.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">pivot</span>(d, tabulate, <span class="kw">c</span>(Dept, Gender), <span class="dt">na_by=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>##    Dept Gender  n
## 1  ACCT      F  3
## 2  ADMN      F  4
## 3  FINC      F  1
## 4  MKTG      F  5
## 5  SALE      F  5
## 6  &lt;NA&gt;      F  1
## 7  ACCT      M  2
## 8  ADMN      M  2
## 9  FINC      M  3
## 10 MKTG      M  1
## 11 SALE      M 10
## 12 &lt;NA&gt;      M  0</code></pre>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
